<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="layout.html"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<div layout:fragment="content">
  <div class="row mt-3">
    <div class="col-12">
      <table class="table table-stripped">
        <thead>
        <tr>
          <th>ID</th>
          <th>NAME</th>
          <th>DESCRIPTION</th>
          <th>PRICE</th>
          <th style="width: 10%;">DETAILS</th>
        </tr>
        </thead>
        <tbody id="courseListBody">

        </tbody>

      </table>



      <script type="text/javascript">
        loadCourses();
        function loadCourses() {
          const httpRequest = new XMLHttpRequest();

          httpRequest.open("GET", "/market", true);
          httpRequest.onreadystatechange = function() {
            if(httpRequest.readyState == XMLHttpRequest.DONE && httpRequest.status == 200) {

              let courseList = JSON.parse(httpRequest.responseText);

              let tableContent = "";

              for (let i = 0; i < courseList.length; i++) {
                console.log(courseList[i].price);
                tableContent+="<tr>";
                tableContent+="<td>"+courseList[i].id+"</td>";
                tableContent+="<td>"+courseList[i].market.name+"</td>";
                tableContent+="<td>"+courseList[i].category.name+"</td>";
                tableContent+="<td>"+courseList[i].price+"</td>";
                tableContent+="<td><button class='btn btn-primary btn-sm' onclick='openCourseDetailModel("+courseList[i].id+")'>DETAILS</button>";
                tableContent+="</tr>";
              }
              document.getElementById("courseListBody").innerHTML=tableContent;

            }
          }
          httpRequest.send();

        }

      </script>

  </div>


</html>